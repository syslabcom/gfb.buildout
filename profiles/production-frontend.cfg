[buildout]
extends = base/solr.cfg

production-parts =
    supervisor
    supervisor-cron
    ${buildout:solr-parts}

dump-picked-versions-file = versions-latest.cfg
allow-picked-versions = false

[deployment]
recipe = gocept.recipe.deploymentsandbox
root = ${buildout:directory}
name = gfb

[settings]
http-address = 8080
zeo-address = localhost:8100
varnish-address = localhost:8008
frontend-address = gfb00.fe.rzob.gocept.net:80
primarydomain = gfb.gocept.com
memcached-address = localhost:11211
supervisor-port = 9002

[zeo]
deployment = deployment

[instance]
<= instance-settings
http-address = 8080
zserver-threads = 1
zeo-client-cache-size = 800MB
zodb-cache-size = 80000
debug-mode = on
verbose-security = on
eggs =
    ${instance-settings:eggs}
    Products.PDBDebugMode

[omelette]
recipe = collective.recipe.omelette
unzip = true
eggs = ${instance:eggs}
ignores =
    elementtree

[zopepy]
recipe = zc.recipe.egg
eggs = ${instance:eggs}
interpreter = zopepy
scripts = zopepy

[supervisor]
port = localhost:9002
serverurl = http://localhost:9002
plugins =
    superlance

programs =
    10 zeo      ${zeo:location}/bin/runzeo  true
    70 solr-instance (stdout_logfile=${buildout:directory}/var/log/solr-instance.log stderr_logfile=${buildout:directory}/var/log/solr-instance.log stdout_logfile_maxbytes=0) java [-Xms512m -Xmx2048m -jar start.jar] ${buildout:directory}/parts/solr-instance [console] true

[supervisor-cron]
recipe = z3c.recipe.usercrontab
times = @reboot
command = ${buildout:bin-directory}/supervisord|& logger -t zope
